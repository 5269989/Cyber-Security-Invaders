import RPi.GPIO as GPIO
import time

# Use BCM numbering
GPIO.setmode(GPIO.BCM)
GPIO.setup(19, GPIO.OUT)

# Set up PWM on GPIO 19 at 50 Hz (standard for SG90)
pwm = GPIO.PWM(19, 50)
pwm.start(0)  # Initialization

def set_angle(angle):
    # Convert angle to duty cycle (for SG90, roughly 2.5 for 0 deg, 12.5 for 180 deg)
    duty = angle / 18 + 2.5
    GPIO.output(19, True)
    pwm.ChangeDutyCycle(duty)
    time.sleep(0.3)  # Allow the servo to move
    GPIO.output(19, False)
    pwm.ChangeDutyCycle(0)  # Avoid jitter by setting duty cycle back to 0

try:
    while True:
        # Turn to 180 degrees
        set_angle(180)
        # Turn back to 0 degrees
        set_angle(0)
        # Turn to 180 degrees again
        set_angle(180)
        # Wait for a second before repeating the cycle
        time.sleep(1)

except KeyboardInterrupt:
    pwm.stop()
    GPIO.cleanup()
